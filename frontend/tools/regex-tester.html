<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regex Tester - Helpful Tools v2</title>
    <link rel="stylesheet" href="/static/css/common-enhancements.css">
    <link rel="stylesheet" href="/static/css/history.css">
    <link rel="stylesheet" href="/static/css/regex-tester.css">
</head>
<body>
    <div class="header">
        <h1>üîç Regex Tester</h1>
        <div class="header-actions">
            <div class="font-controls">
                <label>Font:</label>
                <button id="fontDecreaseBtn" title="Decrease font size">‚àí</button>
                <button id="fontIncreaseBtn" title="Increase font size">+</button>
            </div>
            <button class="hist-toggle-btn" id="historyToggleBtn">üìù History On</button>
            <button class="hist-global-btn" id="globalHistoryBtn">üìö Global History</button>
            <a href="/">‚Üê Back to Tools</a>
        </div>
    </div>
    
    <div class="toolbar">
        <button class="primary" id="testBtn">Test Regex</button>
        <div class="separator"></div>
        <button id="clearBtn">Clear All</button>
        <button id="sampleBtn">Load Sample</button>
        <div class="separator"></div>
        <button id="copyMatchesBtn">Copy Matches</button>
        <div class="separator"></div>
        <div class="hist-container">
            <button class="hist-btn" id="historyBtn">üìã History</button>
            <div class="hist-popup" id="historyPopup">
                <div class="hist-tabs">
                    <button class="hist-tab active" data-tab="history">History</button>
                    <button class="hist-tab" data-tab="data">Data</button>
                </div>
                <div class="hist-content" id="historyContent">
                    <div class="hist-tab-content active" id="historyTab">
                        <div id="historyList">
                            <div class="hist-item">No regex tests saved yet</div>
                        </div>
                    </div>
                    <div class="hist-tab-content" id="dataTab" style="display: none;">
                        <div id="dataList">
                            <div class="hist-item">No saved data available</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="regex-section">
        <div class="regex-input-group">
            <span class="regex-delimiters">/</span>
            <input type="text" class="regex-input" id="regexInput" placeholder="Enter your regular expression...">
            <span class="regex-delimiters">/</span>
        </div>

        <div class="flags-section">
            <span style="color: #555; font-weight: bold;">Flags:</span>
            <div class="flag-group">
                <input type="checkbox" id="flagGlobal" checked>
                <label for="flagGlobal">g (global)</label>
            </div>
            <div class="flag-group">
                <input type="checkbox" id="flagIgnoreCase">
                <label for="flagIgnoreCase">i (ignore case)</label>
            </div>
            <div class="flag-group">
                <input type="checkbox" id="flagMultiline">
                <label for="flagMultiline">m (multiline)</label>
            </div>
            <div class="flag-group">
                <input type="checkbox" id="flagDotAll">
                <label for="flagDotAll">s (dotall)</label>
            </div>
            <div class="flag-group">
                <input type="checkbox" id="flagUnicode">
                <label for="flagUnicode">u (unicode)</label>
            </div>
        </div>

        <div id="regexError" class="regex-error"></div>
        

        <div class="quick-examples">
            <span style="color: #555;">Quick examples:</span>
            <button class="example-btn" data-pattern="\(([0-9]{3})\)[-. ]?([0-9]{3})[-. ]?([0-9]{4})" data-text="Call me at (555) 123-4567\nOr try 555-123-4567\nAlso 555.123.4567\nInvalid: 12-345-6789">USA Phone</button>
            <button class="example-btn" data-pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" data-text="Password123!\nweakpass\nSTRONG456#\nAbc123\nMyP@ssw0rd" data-flags="gm">Strong Password</button>
            <button class="example-btn" data-pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" data-text="Contact: john@example.com\nsupport@company.org\nInvalid: not-email\nuser@test.co.uk">Email</button>
            <button class="example-btn" data-pattern="\d{4}-\d{2}-\d{2}" data-text="Today: 2024-03-15\nBirthday: 1990-12-25\nInvalid: 2024/03/15\nAlso: 2023-01-01">ISO Date</button>
            <button class="example-btn" data-pattern="\$([0-9]{1,3}(,[0-9]{3})*|[0-9]+)(\.[0-9]{2})?" data-text="Price: $19.99\nExpensive: $1,234.56\nCheap: $5\nCost: $12,345.00\nInvalid: 19.99">US Dollar</button>
            <button class="example-btn" data-pattern="^(?![-.])[A-Za-z0-9](?:[A-Za-z0-9._%+-]{0,62}(?<!\.))?(?<!\.)@(?=[A-Za-z0-9])[A-Za-z0-9](?:[A-Za-z0-9.-]{0,251}(?<!\.))?(?<!\.)(\.[A-Za-z]{2,})$|^(?:[1-9]\d{0,2}\.){3}(?:[1-9]\d{0,2})$|^(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}$" data-text="# Valid Emails\njohn.doe@example.com\njane_doe+123@subdomain.test.org\na@domain.co\nlong.local.part12345678901234567890123456789012345678901234567890123@domain.travel\nvalid-email@domain.io\n\n# Invalid Emails\n.invalid@domain.com\ndouble..dot@domain.com\nlocal@domain..com\n@missing.local.com\ntest@-bad.com\ntest@domain.c\nspace in@domain.com\ntoolong.local.part123456789012345678901234567890123456789012345678901234@domain.com\nemail@domain\n\n# Valid IPv4\n192.168.0.1\n1.2.3.4\n255.255.255.255\n\n# Invalid IPv4\n0.0.0.0\n256.1.2.3\n1.2.3\n1.2.3.4.5\n192.168.001.1\n\n# Valid IPv6\n2001:0db8:85a3:0000:0000:8a2e:0370:7334\nffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\n1:2:3:4:5:6:7:8\n\n# Invalid IPv6\n2001:0db8:85a3:0000:0000:8a2e:0370\n2001:0db8:85a3:0000:0000:8a2e:0370:7334:\ng001:0db8:85a3:0000:0000:8a2e:0370:7334\n2001:0db8:85a3:0000:0000:8a2e:0370:7334:extra\n2001:0db8::7334" data-flags="gm">Advanced Email/IP</button>
        </div>
    </div>

    <div class="main-container">
        <div class="left-panel">
            <div class="panel-header">
                Test String
                <span class="match-indicator" id="matchCount">NO MATCHES</span>
            </div>
            <div class="panel-content">
                <textarea class="test-text-area" id="testText" placeholder="Enter your test string here..."></textarea>
            </div>
        </div>

        <div class="right-panel">
            <div class="panel-header">
                Highlighted Matches
                <div class="panel-header-controls">
                    <button class="example-btn" id="showExplanationBtn">üìñ Explain</button>
                    <button class="example-btn" id="toggleMatchesBtn">Show Details</button>
                </div>
            </div>
            <div class="panel-content">
                <div class="highlighted-text" id="highlightedText">
                    <div class="regex-no-match">Enter a regex pattern and test string to see matches highlighted</div>
                </div>
            </div>
            <div class="matches-panel" id="matchesPanel">
                <div class="matches-header">
                    <span>Match Details</span>
                    <span id="matchesCount">0 matches</span>
                </div>
                <div id="matchesList"></div>
            </div>
        </div>
    </div>

    <div class="status-bar">
        <div id="statusText">Ready - Enter a regex pattern and test string</div>
        <div class="status-metrics">
            <div id="regexInfo">Pattern: None | Test length: 0</div>
            <div id="performanceInfo" style="display: none;">‚ö° 0.00ms | 0 steps</div>
        </div>
    </div>

    <!-- Global History Popup -->
    <div class="hist-global-popup" id="globalHistoryPopup">
        <div class="hist-global-header">
            <span>Global History - All Tools</span>
            <button class="hist-close-btn" onclick="window.historyManager?.toggleGlobalHistory()">√ó</button>
        </div>
        <div class="hist-global-content">
            <div id="globalHistoryList">
                <div class="hist-global-item">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Popup Overlay -->
    <div class="regex-popup-overlay" id="popupOverlay"></div>

    <!-- Pattern Explanation Popup -->
    <div class="regex-popup" id="explanationPopup">
        <div class="regex-popup-header">
            <span>üìñ Pattern Explanation</span>
            <button class="regex-popup-close" id="explanationCloseBtn">√ó</button>
        </div>
        <div class="regex-popup-info">
            <div class="popup-pattern" id="explanationPattern"></div>
            <div class="popup-timing" id="explanationTiming"></div>
        </div>
        <div class="regex-popup-content" id="explanationContent">
            <div class="explanation-loading">Analyzing pattern...</div>
        </div>
    </div>

    <!-- Match Details Popup -->
    <div class="regex-popup" id="detailsPopup">
        <div class="regex-popup-header">
            <span>üîç Match Details</span>
            <button class="regex-popup-close" id="detailsCloseBtn">√ó</button>
        </div>
        <div class="regex-popup-info">
            <div class="popup-pattern" id="detailsPattern"></div>
            <div class="popup-timing" id="detailsTiming"></div>
        </div>
        <div class="regex-popup-content" id="detailsContent">
            <div class="no-details">No matches to display</div>
        </div>
    </div>

    <script src="/static/js/common-functions.js"></script>
    <script src="/static/js/history.js"></script>
    <script src="/static/js/regex-tester.js"></script>
</body>
</html>